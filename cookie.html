<!-- 为什么要有cookie，cookie可以实现每次http请求自动给服务器带数据 -->
<!-- 这个demo讲了一个什么事情呢？就是cookie的用法，如何保存用户的登录状态。
如果有document.cookie说明，用户是要保存登录态的，然后把cookie字符串按照"; "分割
提取出键值对，然后填入input框就好了，这实现了一个自动恢复密码用户名的功能。
-->
<!-- cookie失效后浏览器一般会自行删除cookie -->
<!-- cookie在传送的时候,所有键值对都是经过url编码的 -->
<!-- cookie的长度限制一般是4096kb，如果你创建了更长的cookie，多余的部分会被浏览器丢掉 -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <style>
    input:disabled {
      background-color: aqua;
    }
    select {
      height: 20px;
    }
  </style>
  <body>
    <form>
      <label for="">用户名</label>
      <input type="username" />
      <br />
      <br />
      <label>密码</label>
      <input type="password" />
      <br />
      <label>记住我</label>
      <input type="checkbox" name="" id="" />
      <input type="submit" />
      <select name="" id="" size="1">
        <option value="">1</option>
        <option value=""></option>
      </select>
    </form>
    <script>
      const username = document.querySelector('input[type="username"]');
      const checkbox = document.querySelector('input[type="checkbox"]');
      const submit = document.querySelector('input[type="submit"]');
      console.log(username);
      let cookie = {};
      // 浏览器会自动给cookie里的各项属性加上"; "
      // 同一个页面可能有不同的cookie，这时候的key-value都是存在一个cookie字符串里，不同的key-value用"; "分开
      let array = document.cookie.split('; ').map((s) => {
        return s.split('=');
      });
      for (let i of array) {
        let key = i[0];
        let value = i[1];
        cookie[key] = value;
      }

      if (document.cookie) {
        checkbox.checked = true;
        username.value = cookie.username;
      }
      submit.addEventListener('click', (e) => {
        e.preventDefault();
        let key = encodeURIComponent('username');
        let value = encodeURIComponent(username.value);
        console.log(username.value, value);
        let twoDays = 2 * 24 * 60 * 60;
        document.cookie = `${key}=${value};max-age=${twoDays};httpOnly`;
        console.log(document.cookie);
      });
    </script>
  </body>
</html>
